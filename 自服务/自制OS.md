## 自制OS

### 计算机开机

有四次跳转

1. 按下开机键，cpu将pc寄存器的值强制初始化为0xffff0，这个位置是bios程序入口地址
2. 该入口地址也是一个跳转指令，跳转到0xfe05b位置，开始执行
3. bios执行了一些硬件检测工作后，将启动区的内容加载到内存的0x7c00，并跳转到这里
4. 启动区主要加载os，并跳转到加载处

### 前置知识

直接由DOS命令行解释执行的文件，通常后缀为.bat或.cmd，即批量处理文件，.img后缀文件即为映像文件，可以用于制作操作系统文件



**启动区**：boot sector 软盘第一个扇区叫启动区。 扇区：计算机读写软件时512个字节为单位读写的，因此软盘的512字节叫做扇区。 第一个扇区叫做启动区，是因为计算机首先从最初的扇区开始读软盘，然后会检查这个扇区的最后两个字节的内容，如果这两个字节为55，AA， 计算机会认为这个磁盘上没有启动程序。 

为什么是55，AA？ 当初设计师写死的。 

### Makefile

>  Makefile 可以简单的认为是一个工程文件的编译规则，描述了整个工程的编译和链接等规则。其中包含了那些文件需要编译，那些文件不需要编译，那些文件需要先编译，那些文件需要后编译，那些文件需要重建等等。编译整个工程需要涉及到的，在 Makefile 中都可以进行描述。换句话说，Makefile 可以使得我们的项目工程的编译变得自动化，不需要每次都手动输入一堆源文件和参数。

### 汇编

DB：

DW：

DD：data double-word

#### ORG

origin的缩写，起始地址，在汇编语言的源程序的开始一个都用org伪指令实现规定程序的起始地址，如果不用，那么程序将从0000H开始。 

> 预处理-->编译-->汇编-->链接，这是高级语言的编译全过程。对于纯汇编，就只有汇编和链接两个步骤。
>
>
> org指令是链接时使用的，不是汇编那一步使用的。即不是cpu的一条指令，而是给编译器看的伪指令。

#### MOV指令

MOV 指令传送源和目的地可以是常数或者寄存器，也可以是内存地址  

`MOV BYTE [678] ,123 ` 意思时要用内存的678号地址存放123这个数值。

- []的意思是内存地址 

- BYTE， WORD，DWORD 是汇编的保留字

内存地址的指定方法也可以用寄存器：

` BYTE[SI] `如果SI保存的是987，则BYTE[SI] 会被解释为 BYTE[987] 即指定为987号的内存

- 可以这样用的寄存器只有BX，BP，SI，DI，其余的不能用来指定内存地址

## MIT6.828 学习

> 麻省理工的操作系统课程，课程的实验部分包括6个实验， 包含
>
> Booting a PC
> Memory Management
> User Environments
> Preemptive Multitasking
> File system, Spawn and Shell
> Network Driver (default final project)
>
>  完成6个实验后就相当于写完了一个简单的操作系统，并且把bootloader,虚拟内存，进程，多进程，文件系统，网络驱动六个方面的开发熟悉了一遍 。 



### xv6

xv6：x86 version 6 类unix的教学操作系统，jos是在xv6上改写的

### 环境搭建

- 模拟器
- C语言的编译链接调试器

